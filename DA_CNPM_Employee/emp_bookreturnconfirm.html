<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X√°c nh·∫≠n tr·∫£ s√°ch</title>
    <link rel="stylesheet" href="./assets/css/emp_header.css">
    <link rel="stylesheet" href="./assets/css/emp_bookreturnconfirm.css">
</head>
<body>
    <header class="header" id="header"></header>

    <div class="main-container">
        <aside class="sidebar">
            <h3>
                <img src="./assets/img/emp_managedocs_icondanhmuc.svg" alt="Danh m·ª•c Icon" class="icon"> 
                DANH M·ª§C
            </h3>
            <ul>
                <li><a href="/emp_borrow_register.html">ƒêƒÉng k√Ω m∆∞·ª£n</a></li>
                <li><a href="/emp_requestextension.html">Y√™u c·∫ßu gia h·∫°n</a></li>
                <li><a href="/emp_bookreturnconfirm.html">X√°c nh·∫≠n tr·∫£ s√°ch</a></li>
                <li><a href="/emp_overduenotice.html">Th√¥ng b√°o qu√° h·∫°n</a></li>
            </ul>
        </aside>

        <section class="content">
            <h2>X√ÅC NH·∫¨N TR·∫¢ S√ÅCH</h2>

            <div class="return-table-container">
                <table class="return-table" id="return-table">
                    <thead>
                        <tr>
                            <th>CCCD <span class="filter-icon" onclick="sortTable(0)">üîΩ</span></th>
                            <th>ID s√°ch <span class="filter-icon" onclick="sortTable(1)">üîΩ</span></th>
                            <th>T√™n s√°ch <span class="filter-icon" onclick="sortTable(2)">üîΩ</span></th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Ph√≠ ph·∫°t</th>
                            <th>
                                X·ª≠ l√Ω y√™u c·∫ßu
                                <select id="filterStatus">
                                    <option value="T·∫•t c·∫£">T·∫•t c·∫£</option>
                                    <option value="ƒê√£ x·ª≠ l√Ω">ƒê√£ x·ª≠ l√Ω</option>
                                    <option value="X√°c nh·∫≠n">Ch∆∞a x·ª≠ l√Ω</option>
                                </select>                                                              
                            </th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr>
                            <td>001282946366</td>
                            <td>CH1003</td>
                            <td>H√≥a ƒë·∫°i c∆∞∆°ng</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status processed">ƒê√£ x·ª≠ l√Ω</td>
                        </tr>
                        <tr>
                            <td>005225702399</td>
                            <td>MT1003</td>
                            <td>Gi·∫£i t√≠ch 1</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>002301234798</td>
                            <td>SP1031</td>
                            <td>Tri·∫øt h·ªçc M√°c - L√™nin</td>
                            <td>Tr·ªÖ 1 ng√†y, nguy√™n v·∫πn</td>
                            <td>10.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>001282946366</td>
                            <td>PH1003</td>
                            <td>V·∫≠t l√Ω 1</td>
                            <td>Tr·ªÖ 7 ng√†y, nguy√™n v·∫πn</td>
                            <td>50.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>078901234567</td>
                            <td>ME3005</td>
                            <td>Thi·∫øt k·∫ø h·ªá th·ªëng c∆° ƒëi·ªán t·ª≠</td>
                            <td>ƒê√∫ng h·∫°n, r√°ch b√¨a</td>
                            <td>20.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>089012345678</td>
                            <td>AS3077</td>
                            <td>C∆° s·ªü v·∫≠t l√Ω s·ª£i quang h·ªçc v√† ·ª©ng d·ª•ng</td>
                            <td>Tr·ªÖ 7 ng√†y, nguy√™n v·∫πn</td>
                            <td>50.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>090123456789</td>
                            <td>TR3077</td>
                            <td>Th√≠ nghi·ªám k·ªπ thu·∫≠t h√†ng kh√¥ng 1</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>
                        <tr>
                            <td>091343356418</td>
                            <td>MT2013</td>
                            <td>X√°c su·∫•t th·ªëng k√™</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>              
                        <tr>
                            <td>035456789012</td>
                            <td>PH1007</td>
                            <td>Th√≠ nghi·ªám v·∫≠t l√Ω</td>
                            <td>Tr·ªÖ 7 ng√†y, nguy√™n v·∫πn</td>
                            <td>50.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>                    
                        <tr>
                            <td>098765432109</td>
                            <td>SP1035</td>
                            <td>Ch·ªß nghƒ©a x√£ h·ªôi khoa h·ªçc</td>
                            <td>Tr·ªÖ 3 ng√†y, nguy√™n v·∫πn</td>
                            <td>30.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>                       
                        <tr>
                            <td>052345678901</td>
                            <td>IM1025</td>
                            <td>Qu·∫£n l√Ω d·ª± √°n cho k·ªπ s∆∞</td>
                            <td>Tr·ªÖ 2 ng√†y, nguy√™n v·∫πn</td>
                            <td>20.000 VND</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>                        
                        <tr>
                            <td>089012302137</td>
                            <td>CO2013</td>
                            <td>H·ªá c∆° s·ªü d·ªØ li·ªáu</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>                        
                        <tr>
                            <td>098033432346</td>
                            <td>CO3001</td>
                            <td>C√¥ng ngh·ªá ph·∫ßn m·ªÅm</td>
                            <td>ƒê√∫ng h·∫°n, nguy√™n v·∫πn</td>
                            <td>0</td>
                            <td class="status confirm">
                                <span class="confirm" onclick="confirmReturn(this)">X√°c nh·∫≠n</span>
                            </td>
                        </tr>                      
                                      
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <script src="script.js"></script>
    <script>
        async function loadHeader() {
            const headerContainer = document.getElementById("header");
            const response = await fetch("emp_header.html");
            const headerHTML = await response.text();
            headerContainer.innerHTML = headerHTML;
        }
        loadHeader();

        const sortStates = [true, true, true]; // Tr·∫°ng th√°i s·∫Øp x·∫øp

        // H√†m l·ªçc tr·∫°ng th√°i "X·ª≠ l√Ω y√™u c·∫ßu"
        function filterTableByStatus() {
            const filterValue = document.getElementById("filterStatus").value;
            const rows = document.querySelectorAll(".return-table tbody tr");

            rows.forEach(row => {
                const statusCell = row.cells[5];
                const cellContent = statusCell.textContent.trim();
                const hasConfirm = statusCell.querySelector(".confirm");

                if (filterValue === "T·∫•t c·∫£" ||
                    (filterValue === "ƒê√£ x·ª≠ l√Ω" && cellContent === "ƒê√£ x·ª≠ l√Ω") ||
                    (filterValue === "X√°c nh·∫≠n" && hasConfirm)) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        }
        document.getElementById("filterStatus").addEventListener("change", filterTableByStatus);

        function sortTable(columnIndex) {
            const table = document.getElementById("return-table");
            const rows = Array.from(table.querySelectorAll("tbody tr"));
            const sortDirection = sortStates[columnIndex];
            sortStates[columnIndex] = !sortStates[columnIndex];

            rows.sort((a, b) => {
                const cellA = a.cells[columnIndex].textContent.trim();
                const cellB = b.cells[columnIndex].textContent.trim();
                return sortDirection 
                    ? cellA.localeCompare(cellB, 'vi', { numeric: true }) 
                    : cellB.localeCompare(cellA, 'vi', { numeric: true });
            });

            rows.forEach(row => table.querySelector("tbody").appendChild(row));
        }

        function confirmReturn(element) {
            alert("X√°c nh·∫≠n tr·∫£ s√°ch th√†nh c√¥ng");
            const row = element.closest("tr");
            const statusCell = row.querySelector(".status");
            statusCell.textContent = "ƒê√£ x·ª≠ l√Ω";
            statusCell.className = "status processed";
        }
    </script>
</body>
</html>
